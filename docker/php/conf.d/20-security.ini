; Errors and exposure
expose_php=0
display_errors=0
log_errors=1
error_log=/proc/self/fd/2

; Execution/resource limits
memory_limit=128M
max_execution_time=30
max_input_time=30
max_input_vars=2000
post_max_size=16M
upload_max_filesize=16M

; File system sandbox
open_basedir=/var/www/html/public:/var/www/html/src:/tmp

; Sessions
session.use_strict_mode=1
session.cookie_httponly=1
session.cookie_secure=1
session.cookie_samesite=Lax
session.use_only_cookies=1
session.sid_length=48
session.sid_bits_per_character=6

; Assertions and dynamic loading
zend.assertions=-1
enable_dl=0

; CGI handling (defense-in-depth for path info handling)
cgi.fix_pathinfo=0

; Opcache (prod)
opcache.enable=1
opcache.enable_cli=0
opcache.validate_timestamps=0
opcache.max_accelerated_files=10000
opcache.memory_consumption=128
opcache.interned_strings_buffer=16

; Realpath cache
realpath_cache_size=4096k
realpath_cache_ttl=300

date.timezone=UTC